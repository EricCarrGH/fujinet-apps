/**
 * @brief #FujiNet Reversi
 * @author  Thomas Cherryhomes
 * @email   thom dot cherryhomes at gmail dot com
 * @license gpl v. 3
 */

#include <conio.h>
#include <string.h>
#include "csram.h"
#include "video.h"

unsigned char count_white, count_black;

/**
 * @brief board positions to check in color RAM
 */
unsigned short board_pos[64]=
    {
      26,28,30,32,34,36,38,40,
      92,94,96,98,100,102,104,106,
      136,138,140,142,144,146,148,150,
      180,182,184,186,188,190,192,194,
      224,226,228,230,232,234,236,238,
      272,274,276,278,280,282,284,286,
      316,318,320,322,324,326,328,330,
      360,362,364,366,368,370,372,374
    };

/**
 * @brief initial board color RAM data
 */
char board_color[] =
  {
    0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,

    0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,
    0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,

    0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,
    0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,

    0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,
    0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,

    0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x08,0x08,0x09,0x09,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,
    0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x08,0x08,0x09,0x09,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,

    0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x09,0x09,0x08,0x08,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,
    0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x09,0x09,0x08,0x08,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,

    0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,
    0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,

    0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,
    0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,

    0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,
    0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,

    0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,0x0D,    
  };

/**
 * @brief initial board video RAM
 */
char board_char[] =
  {
    0x20,0x20,0x41,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x48,0x20,0x20,
    
    0x20,0x20,0x3F,0x42,0x43,0x42,0x43,0x42,0x43,0x42,0x43,0x42,0x43,0x42,0x43,0x42,0x43,0x42,0x43,0x47,0x20,0x20,
    0x20,0x20,0x3F,0x44,0x45,0x44,0x45,0x44,0x45,0x44,0x45,0x44,0x45,0x44,0x45,0x44,0x45,0x44,0x45,0x47,0x20,0x20,

    0x20,0x20,0x3F,0x42,0x43,0x42,0x43,0x42,0x43,0x42,0x43,0x42,0x43,0x42,0x43,0x42,0x43,0x42,0x43,0x47,0x20,0x20,
    0x20,0x20,0x3F,0x44,0x45,0x44,0x45,0x44,0x45,0x44,0x45,0x44,0x45,0x44,0x45,0x44,0x45,0x44,0x45,0x47,0x20,0x20,

    0x20,0x20,0x3F,0x42,0x43,0x42,0x43,0x42,0x43,0x42,0x43,0x42,0x43,0x42,0x43,0x42,0x43,0x42,0x43,0x47,0x20,0x20,
    0x20,0x20,0x3F,0x44,0x45,0x44,0x45,0x44,0x45,0x44,0x45,0x44,0x45,0x44,0x45,0x44,0x45,0x44,0x45,0x47,0x20,0x20,

    0x20,0x20,0x3F,0x42,0x43,0x42,0x43,0x42,0x43,0x3B,0x3C,0x3B,0x3C,0x42,0x43,0x42,0x43,0x42,0x43,0x47,0x20,0x20,
    0x20,0x20,0x3F,0x44,0x45,0x44,0x45,0x44,0x45,0x3D,0x3E,0x3D,0x3E,0x44,0x45,0x44,0x45,0x44,0x45,0x47,0x20,0x20,

    0x20,0x20,0x3F,0x42,0x43,0x42,0x43,0x42,0x43,0x3B,0x3C,0x3B,0x3C,0x42,0x43,0x42,0x43,0x42,0x43,0x47,0x20,0x20,
    0x20,0x20,0x3F,0x44,0x45,0x44,0x45,0x44,0x45,0x3D,0x3E,0x3D,0x3E,0x44,0x45,0x44,0x45,0x44,0x45,0x47,0x20,0x20,

    0x20,0x20,0x3F,0x42,0x43,0x42,0x43,0x42,0x43,0x42,0x43,0x42,0x43,0x42,0x43,0x42,0x43,0x42,0x43,0x47,0x20,0x20,
    0x20,0x20,0x3F,0x44,0x45,0x44,0x45,0x44,0x45,0x44,0x45,0x44,0x45,0x44,0x45,0x44,0x45,0x44,0x45,0x47,0x20,0x20,

    0x20,0x20,0x3F,0x42,0x43,0x42,0x43,0x42,0x43,0x42,0x43,0x42,0x43,0x42,0x43,0x42,0x43,0x42,0x43,0x47,0x20,0x20,
    0x20,0x20,0x3F,0x44,0x45,0x44,0x45,0x44,0x45,0x44,0x45,0x44,0x45,0x44,0x45,0x44,0x45,0x44,0x45,0x47,0x20,0x20,

    0x20,0x20,0x3F,0x42,0x43,0x42,0x43,0x42,0x43,0x42,0x43,0x42,0x43,0x42,0x43,0x42,0x43,0x42,0x43,0x47,0x20,0x20,
    0x20,0x20,0x3F,0x44,0x45,0x44,0x45,0x44,0x45,0x44,0x45,0x44,0x45,0x44,0x45,0x44,0x45,0x44,0x45,0x47,0x20,0x20,

    0x20,0x20,0x4A,0x46,0x46,0x46,0x46,0x46,0x46,0x46,0x46,0x46,0x46,0x46,0x46,0x46,0x46,0x46,0x46,0x49,0x20,0x20    
  };

/**
 * @brief count # of pieces to white/black
 */
void board_count(void)
{
  unsigned char i;

  count_white=
    count_black=0;
  
  for (i=0;i<sizeof(pos);i++)
    {
      if (pos[i]==0x08)
	count_white++;
      else if (pos[i]==0x09)
	count_black++;
    }
}

void main(void)
{
  video_setup();

  VIC.bg_border_color=216; // Light Green / Dark Green
  VIC.volume_color=0x80;   // Orange aux color.

  clrscr();

  memcpy(COLOR_RAM,board_color,sizeof(board_color));
  memcpy(VIDEO_RAM,board_char,sizeof(board_char));

  board_count();
  
  while(1);
}
